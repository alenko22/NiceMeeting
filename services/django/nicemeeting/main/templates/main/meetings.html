{% extends 'main/base.html' %}
{% load static %}

{% block title %}
Ваши встречи — Nice Meeting
{% endblock %}

{% block content %}
<div class="page-content">
    <div class="container container--wide">
        <h1 class="meetings__title">Ваши встречи</h1>
        <p class="meetings__subtitle">Здесь отображаются все запланированные встречи с другими пользователями</p>

        {% if meetings %}
            <div class="meetings__grid">
                {% for meeting in meetings %}
                <div class="meetings__item">
                    <div class="meetings__content">
                        <div class="meetings__header">
                            <h2 class="meetings__name">{{ meeting.user1.get_full_name }} ↔ {{ meeting.user2.get_full_name }}</h2>
                        </div>

                        <div class="meetings__meta">
                            {% if meeting.event %}
                            <div class="meetings__meta-item">
                                <svg class="meetings__meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                </svg>
                                <span class="meetings__meta-text">Мероприятие: <strong>{{ meeting.event.name }}</strong></span>
                            </div>
                            {% elif meeting.place %}
                            <div class="meetings__meta-item">
                                <svg class="meetings__meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                                <span class="meetings__meta-text">Место: <strong>{{ meeting.place }}</strong></span>
                            </div>
                            {% endif %}

                            <div class="meetings__meta-item">
                                <svg class="meetings__meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                    <line x1="16" y1="2" x2="16" y2="6"/>
                                    <line x1="8" y1="2" x2="8" y2="6"/>
                                    <line x1="3" y1="10" x2="21" y2="10"/>
                                </svg>
                                <span class="meetings__meta-text">{{ meeting.datetime|date:"d E Y" }}</span>
                            </div>

                            <div class="meetings__meta-item">
                                <svg class="meetings__meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10"/>
                                    <polyline points="12 6 12 12 16 14"/>
                                </svg>
                                <span class="meetings__meta-text">Начало в {{ meeting.datetime|time:"H:i" }}</span>
                            </div>

                            <div class="meetings__meta-item">
                                <svg class="meetings__meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="12" cy="12" r="10"/>
                                    <polyline points="12 6 12 12 16 14"/>
                                </svg>
                                <span class="meetings__countdown" data-datetime="{{ meeting.datetime|date:'c' }}">
                                    До начала: <strong class="meetings__countdown-value">--</strong>
                                </span>
                            </div>
                        </div>

                        <div class="meetings__footer">
                            <div class="meetings__actions">
                                <a href="{% url 'meeting_details' meeting.id %}" class="btn btn-primary">Подробнее</a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            {% if page_obj.has_other_pages %}
            <div class="meetings__pagination">
                {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}" class="btn btn-outline meetings__pagination-btn">← Предыдущая</a>
                {% endif %}

                <span class="meetings__pagination-info">
                    Страница {{ page_obj.number }} из {{ page_obj.paginator.num_pages }}
                </span>

                {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}" class="btn btn-outline meetings__pagination-btn">Следующая →</a>
                {% endif %}
            </div>
            {% endif %}
        {% else %}
            <div class="meetings__empty">
                <svg class="meetings__empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <p class="meetings__empty-text">У вас пока нет запланированных встреч</p>
                <a href="{% url 'events' %}" class="btn btn-primary href">Найти мероприятие</a>
            </div>
        {% endif %}
    </div>
</div>

{% block extra_js %}
    <script src="{% static 'js/meetings.js' %}"></script>
{% endblock %}
{% endblock %}