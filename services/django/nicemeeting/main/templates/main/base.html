{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %} {% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/main_style.css' %}">
</head>
<body>
<header class="site-header">
    <!-- Логотип слева, кликабельный -->
    <a class="logo" href="about.html" aria-label="О нас — перейти">
        <!-- Простая svg-иконка + текст -->
        <svg width="40" height="40" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path fill="#f7c7d4" d="M12 21s-6-4.35-8-7.16C1.5 10.7 4.42 6 8.5 6c2.22 0 3.7 1.35 3.5 3 0 0 1.28-2.9 4.5-2.9C19.9 6.1 22.5 9.6 20 13.84 18 17.1 12 21 12 21z"/>
        </svg>
        <span class="logo-text">Nice Meeting</span>
    </a>

    <!-- Название приложения по центру -->
    <h1 class="app-title">Nice Meeting</h1>

    <!-- Правая область: навигация + auth -->
    <div class="right-area">
        <nav class="main-nav" aria-label="Основная навигация">
            <a href="/search" class="nav-link">Поиск</a>
            <a href="/chats" class="nav-link">Чаты</a>
        </nav>

        <!-- Здесь отображается либо кнопки вход/рег, либо аватар + выпадашка -->
        <div class="auth-area" id="authArea">
            <!-- Неавторизованный вид -->
            <div class="not-auth" id="notAuth">
                <a class="btn btn-outline" href="/login">Войти</a>
                <a class="btn btn-primary" href="/register">Зарегистрироваться</a>
            </div>

            <!-- Авторизованный вид -->
            <div class="is-auth" id="isAuth" hidden>
                <button class="avatar-btn" id="avatarBtn" aria-haspopup="true" aria-expanded="false">
                    <img class="avatar" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='40' height='40'><rect rx='20' width='40' height='40' fill='%23f2a7b9'/></svg>" alt="Аватар">
                    <span class="visually-hidden">Меню пользователя</span>
                </button>
                <ul class="user-menu" id="userMenu" role="menu" aria-label="Меню пользователя" hidden>
                    <li role="none"><a role="menuitem" href="/profile">Профиль</a></li>
                    <li role="none"><a role="menuitem" href="/settings">Настройки</a></li>
                    <li role="none"><a role="menuitem" href="/logout" id="logoutLink">Выйти</a></li>
                </ul>
            </div>
        </div>

        <!-- Гамбургер для мобильных -->
        <button class="hamburger" id="hamburger" aria-label="Открыть меню" aria-expanded="false">
            <span class="hamburger-bar"></span>
            <span class="hamburger-bar"></span>
            <span class="hamburger-bar"></span>
        </button>
    </div>
</header>
<main>{% block content %} {% endblock %}
    <div class="demo-controls">
        <button id="simulateLogin" class="btn">Симулировать вход</button>
        <button id="simulateLogout" class="btn btn-outline">Симулировать выход</button>
    </div>
</main>
<footer class="site-footer">
    <div class="footer-grid">
        <div class="footer-col about">
            <h3>О проекте</h3>
            <p>«Nice Meeting» — конфиденциальная платформа знакомств для тех, кто ищет искренние отношения. Мы поддерживаем безопасность и уважение.</p>
            <p>Версия: демо • © 2025</p>
        </div>

        <div class="footer-col help">
            <h3>Помощь</h3>
            <nav>
                <a href="/faq" class="footer-link">FAQ</a>
                <a href="/safety" class="footer-link">Правила безопасности</a>
                <a href="/how-it-works" class="footer-link">Как это работает</a>
            </nav>
        </div>

        <div class="footer-col support">
            <h3>Поддержка</h3>
            <p>Почта: <a href="mailto:support@lyublyu.com">support@lyublyu.com</a></p>
            <p>Телефон: +7 (800) 123-45-67</p>
            <div class="socials">
                <a href="#" aria-label="Telegram">TG</a>
                <a href="#" aria-label="Instagram">IG</a>
                <a href="#" aria-label="Вконтакте">VK</a>
            </div>
        </div>
    </div>

    <div class="footer-bottom">
        <small>Политика конфиденциальности • Условия использования</small>
    </div>
</footer>
<script>
    // Простейшая логика показа/скрытия меню + переключение состояния "авторизован/не авторизован"
    (function () {
        const isAuth = { value: false }; // менять через демо-кнопки
        const notAuth = document.getElementById('notAuth');
        const isAuthBlock = document.getElementById('isAuth');
        const avatarBtn = document.getElementById('avatarBtn');
        const userMenu = document.getElementById('userMenu');
        const hamburger = document.getElementById('hamburger');
        const mainNav = document.querySelector('.main-nav');

        function renderAuth() {
            if (isAuth.value) {
                notAuth.hidden = true;
                isAuthBlock.hidden = false;
            } else {
                notAuth.hidden = false;
                isAuthBlock.hidden = true;
                userMenu.hidden = true;
                avatarBtn && avatarBtn.setAttribute('aria-expanded', 'false');
            }
        }

        // avatar dropdown
        if (avatarBtn) {
            avatarBtn.addEventListener('click', () => {
                const opened = userMenu.hidden;
                userMenu.hidden = !opened;
                avatarBtn.setAttribute('aria-expanded', String(opened));
            });
        }

        // close dropdown on click outside
        document.addEventListener('click', (e) => {
            if (!isAuthBlock.contains(e.target) && !userMenu.hidden) {
                userMenu.hidden = true;
                avatarBtn.setAttribute('aria-expanded', 'false');
            }
        });

        // hamburger toggle for mobile nav
        hamburger.addEventListener('click', () => {
            const expanded = hamburger.getAttribute('aria-expanded') === 'true';
            hamburger.setAttribute('aria-expanded', String(!expanded));
            mainNav.classList.toggle('open');
        });

        // demo buttons
        document.getElementById('simulateLogin').addEventListener('click', () => {
            isAuth.value = true; renderAuth();
        });
        document.getElementById('simulateLogout').addEventListener('click', () => {
            isAuth.value = false; renderAuth();
        });

        renderAuth();
    })();
</script>
</body>
</html>